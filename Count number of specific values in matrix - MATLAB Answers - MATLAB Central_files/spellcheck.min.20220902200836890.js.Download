var mwSpellCheckLib={init:function(a){a.targetElementId&&a.searchParams&&a.suggestions&&(new mwSpellChecker(a)).displaySpellCheckDiv()}};
function mwSpellChecker(a){this.emptyDivTemplate="";this.spellcheckDisplayLimit=20;this.divTemplate='\x3cp\x3e\x3cspan style\x3d"color:#dd4b39"\x3e{{spellcheck_display_text}} \x3c/span\x3e\x3ca href\x3d"{{url}}"\x3e{{suggestion_text}}\x3c/a\x3e {{resultscount_display}}\x3c/p\x3e';this.targetElementId=a.targetElementId;this.searchParams=a.searchParams;this.suggestions=a.suggestions;this.spellcheckDisplayText="Did you mean:";this.displayResultsCount=!0;a.spellcheckDisplayText&&(this.spellcheckDisplayText=
a.spellcheckDisplayText);!1===a.displayResultsCount&&(this.displayResultsCount=!1);a.spellcheckDisplayLimit&&(this.spellcheckDisplayLimit=a.spellcheckDisplayLimit);this.space_regex=/\s/g;this.tracking_code="\x26s_tid\x3dsrch_dym_sug"}
mwSpellChecker.prototype.displaySpellCheckDiv=function(){try{if(!this.isSuggestionAvailable())throw"suggestion not available";var a="",b=document.getElementById(this.targetElementId),c={url:"",suggestion_text:"",resultscount_display:""},e=this.htmlentities.decode(decodeURIComponent(document.URL)),d=this.searchParams.q||this.searchParams.term||this.searchParams.query||this.searchParams.srchtxt||this.searchParams.keywords||this.searchParams.search_terms;d=this.htmlentities.decode(d);var f=d.replace(this.space_regex,
"+");f=this.escapeSpecialChars(f);var l=new RegExp("(\x26|\\?)(q|query|srchtxt|keywords|term|search_terms)(\x3d)"+f,"gi"),g=this.correctMisspelledTerms(d);if(g===d)throw"No spell correction applied!";var h=this.highlightAndHTMLEncode(d,g);c.suggestion_text=h.suggestion_text;a=h.html_encoded_search_term;var m=this.buildURL(l,a,e),n=this.checkIfFacetedQuery("q query srchtxt keywords term search_terms".split(" ")),k=this.addDisplayCountAndTrackingCode(n,m);c.url=k.url;c.resultscount_display=k.resultscount_display;
this.replaceTemplate(c);b.innerHTML=this.divTemplate}catch(p){b.innerHTML=this.emptyDivTemplate}};mwSpellChecker.prototype.escapeSpecialChars=function(a){return a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")};mwSpellChecker.prototype.isSuggestionAvailable=function(){return this.suggestions.query};mwSpellChecker.prototype.isZeroHits=function(){return 0===this.suggestions.hits};
mwSpellChecker.prototype.correctMisspelledTerms=function(a){for(var b=this.suggestions.misspelled_words,c=0;c<b.length;c+=2)a=a.replace(new RegExp("(\\b|_)"+b[c]+"(\\b|_)","i"),"$1"+b[c+1]+"$2");return a};
mwSpellChecker.prototype.highlightAndHTMLEncode=function(a,b){a=a.split(this.space_regex);b=b.split(this.space_regex);for(var c="",e="",d=0;d<a.length;d++)a[d]===b[d]?(c+=this.htmlentities.encode(a[d])+" ",e+=this.htmlentities.encode(a[d])+" "):(c+="\x3cb\x3e\x3ci\x3e"+this.htmlentities.encode(b[d])+"\x3c/i\x3e\x3c/b\x3e ",e+=this.htmlentities.encode(b[d])+" ");return{suggestion_text:c.trim(),html_encoded_search_term:e.trim()}};
mwSpellChecker.prototype.buildURL=function(a,b,c){b=b.replace(this.space_regex,"+");return c.replace(a,"$1$2$3"+b)};mwSpellChecker.prototype.checkIfFacetedQuery=function(a){var b=!1;Object.keys(this.searchParams).forEach(function(c){0<=a.indexOf(c)&&(b=!0)});return b};
mwSpellChecker.prototype.addDisplayCountAndTrackingCode=function(a,b){a&&this.isZeroHits()?(a=encodeURI(b+this.tracking_code),b="(Search without filters)"):(a=encodeURI(b+this.tracking_code),b="("+this.suggestions.hits+" results)");return{url:a,resultscount_display:b}};
mwSpellChecker.prototype.replaceTemplate=function(a){this.divTemplate=this.divTemplate.replace(/{{url}}/g,a.url);this.divTemplate=this.divTemplate.replace(/{{suggestion_text}}/g,a.suggestion_text);this.divTemplate=this.divTemplate.replace(/{{spellcheck_display_text}}/g,this.spellcheckDisplayText);var b=/{{resultscount_display}}/g;this.divTemplate=this.displayResultsCount?this.divTemplate.replace(b,a.resultscount_display):this.divTemplate.replace(b,"")};
mwSpellChecker.prototype.htmlentities={encode:function(a){for(var b=[],c=a.length-1;0<=c;c--)b.unshift(["\x26#",a[c].charCodeAt(),";"].join(""));return b.join("")},decode:function(a){var b=document.createElement("textarea");b.innerHTML=a;return b.value}};